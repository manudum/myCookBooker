 {% extends '::base.html.twig' %}

 {% block body %}

{% include 'CookbookCoreBundle:Default:header.html.twig' %}

<div id="content_header"><h1>Mes plats</h1>
</div>


<div id="content_left">


<div class="stepImg">
<img src="{{ asset('bundles/cookbookcore/images/spoon.png') }}" />
</div>




</div>
<div id="content_middle">
    <div id="recipes"></div>
<div class="recipes">
<a class="lienAdd" href="{{ path('recipe_new') }}"><img src="{{ asset('bundles/cookbookcore/images/plus.gif') }}" border="0" /></a>
                
<ul> 
                    {% for category in categories %}
                                <li><a href="{{ path('recipe_show', { 'id': category.id }) }}">{{ category.name }}</a>({{ category.recipes|length }})</li>
                    
                    {% endfor %}
                    </ul>
<ul> 
                    {% for recipe in user.recipes %}
                                <li><a href="{{ path('recipe_show', { 'id': recipe.id }) }}">{{ recipe.name }}</a></li>
                    {% endfor %}
                    </ul>
<a href="{{ path('recipe_new') }}">Ajouter une recette</a>
 </div>
</div>
<div id="content_right">
   
  <label class="libFiltre"> Cat√©gorie</label> 
    <select id="category" name="category">
        <option value="" selected="selected"><label for="category0">Tous</label></option>
 {% for category in categories %}
        <option value="{{ category.id }}"><label for="category{{ category.id }}">{{ category.name }}</label></option>
{% endfor %}
</select><br>
  <label class="libFiltre"> Type</label> 
    <select id="type" name="type">
        <option value="" selected="selected"><label for="type0">Tous</label></option>
 {% for type in types %}
        <option value="{{ type.id }}"><label for="type{{ type.id }}">{{ type.name }}</label></option>
{% endfor %}
</select><br>

  <label class="libFiltre"> Format</label> 
    <select id="format" name="format">
        <option value="" selected="selected"><label for="format0">Tous</label></option>
 {% for format in formats %}
        <option value="{{ format.id }}"><label for="format{{ format.id }}">{{ format.name }}</label></option>
{% endfor %}
    </select>
 </div>

 {% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript">
$(document).ready(function() {

    if ( $("#stepRecipe") )  $("#stepRecipe").click(function(){
        window.location = '{{ path('recipe_new') }}';
    });
    if ( $("#stepEvent") )  $("#stepEvent").click(function(){
        window.location = '{{ path('event_new') }}';
    });
    if ( $("#stepFriend") )  $("#stepFriend").click(function(){
        window.location = '{{ path('friend_new') }}';
    });

    $('#category').change(refreshRecipes); 
    $('#format').change(refreshRecipes); 
    $('#type').change(refreshRecipes); 

    if ($('#category').val() || $('#format').val() || $('#type').val()){
        refreshRecipes();
    }

});

function refreshRecipes()
{
    //get the url for the form
    var url='../get';

    //start send the post request
    $.post(url,{
           category:$('#category').attr('value'),
           type:$('#type').attr('value'),
           format:$('#format').attr('value')
       },function(data){
        //the response is in the data variable
            $('#recipes').html(data);
            
    }, 'html');//It is silly. But you should not write 'json' or any thing as the fourth parameter. It should be undefined. I'll explain it futher down


}
</script>
 {% endblock %}